<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.phoenix.web.mapper.SysPermissionMapper">

    <select id="selectPermissionByUserId" resultType="SysPermission">
        SELECT DISTINCT p.`id`,
                        p.`parent_id`,
                        p.`name`,
                        p.`code`,
                        p.`url`,
                        p.`type`,
                        p.`icon`,
                        p.`remark`,
                        p.`create_date`,
                        p.`update_date`
        FROM sys_user u
                 LEFT JOIN sys_user_role ur ON u.id = ur.user_id
                 LEFT JOIN sys_role r ON ur.role_id = r.id
                 LEFT JOIN sys_role_permission rp ON r.id = rp.role_id
                 LEFT JOIN sys_permission p ON p.id = rp.permission_id
        WHERE u.id = #{userId}
    </select>

    <select id="findByRoleId" resultType="SysPermission">
        select distinct p.*
        from sys_permission p
                 left join sys_role_permission rp on p.id = rp.permission_id
                 left join sys_role r on rp.role_id = r.id
        where rp.role_id = #{roleId}
        order by p.id asc
    </select>

</mapper>